# ðŸ“Š C11Q28 â€“ Truffle Market Equilibrium Analysis (Aâ€“F)

This project analyzes the supply and demand system for truffles by estimating structural equations using 2SLS and OLS, computing price elasticity, plotting curves, and comparing equilibrium values.

---

## (a) Rewriting Demand and Supply Equations with Price on LHS

### Demand Equation

Original form:


Rewritten with price as the dependent variable:


### Supply Equation

Original form:


Rewritten:


> **Expected signs:**  
> - Î´â‚‚ < 0 (inverse demand)  
> - Ï†â‚‚ > 0 (positive supply)  
> - Î´â‚ƒ, Î´â‚„, Ï†â‚ƒ > 0 (economic intuition)

---

## (b) Estimation with Two-Stage Least Squares (2SLS)

```r
library(AER)

# Load data
data("truffles")  # Replace with actual import if needed

# Estimate demand equation
demand_2sls <- ivreg(P ~ Q + PS + DI | PS + DI + PF, data = truffles)

# Estimate supply equation
supply_2sls <- ivreg(P ~ Q + PF | PF + PS + DI, data = truffles)

summary(demand_2sls)
summary(supply_2sls)
mean_P <- 62.724
mean_Q <- 18.458
delta_2 <- -2.6705

elasticity <- (1 / delta_2) * (mean_P / mean_Q)
# Result: -1.2725
curve_demand <- function(Q) 111.5801 - 2.6705 * Q
curve_supply <- function(Q) 9.2470 + 2.9367 * Q

curve(curve_demand, from = 10, to = 25, col = "blue", ylab = "Price", xlab = "Quantity")
curve(curve_supply, from = 10, to = 25, col = "red", add = TRUE)
legend("topright", legend = c("Demand", "Supply"), col = c("blue", "red"), lty = 1)
111.5801 âˆ’ 2.6705Â·Q = 9.2470 + 2.9367Â·Q
Q = 18.2503
P = 62.8427
Q = 7.8951 + 0.6564Â·PF + 2.1672Â·DI âˆ’ 0.5070Â·PS = 18.2604  
P = âˆ’32.5124 + 1.7081Â·PF + 7.6025Â·DI + 1.3539Â·PS = 62.8154
# OLS estimation
demand_ols <- lm(P ~ Q + PS + DI, data = truffles)
supply_ols <- lm(P ~ Q + PF, data = truffles)

summary(demand_ols)
summary(supply_ols)
