# C11Q28 Truffle Market Equilibrium Analysis: A–F Integration

This project analyzes the supply and demand system for truffles by estimating structural equations using 2SLS and OLS, computing price elasticity, plotting curves, and comparing equilibrium values.

---

## (a) Rewriting Demand and Supply Equations with Price on LHS

### Demand Equation

Original form:
```math
Q = α₁ + α₂·P + α₃·PS + α₄·DI + eᵈ

## (b) Estimation with Two-Stage Least Squares (2SLS)
library(AER)

# Load data
data("truffles")  # Replace with actual import

# Estimate demand equation (inverted)
demand_2sls <- ivreg(P ~ Q + PS + DI | PS + DI + PF, data = truffles)

# Estimate supply equation (inverted)
supply_2sls <- ivreg(P ~ Q + PF | PF + PS + DI, data = truffles)

summary(demand_2sls)
summary(supply_2sls)


## (c) Price Elasticity of Demand at Sample Means
mean_P <- 62.724
mean_Q <- 18.458
delta_2 <- -2.6705

elasticity <- (1 / delta_2) * (mean_P / mean_Q)
# Result: -1.2725


## (d) Plotting Supply and Demand Curves
curve_demand <- function(Q) 111.5801 - 2.6705 * Q
curve_supply <- function(Q) 9.2470 + 2.9367 * Q

curve(curve_demand, from = 10, to = 25, col = "blue", ylab = "Price", xlab = "Quantity")
curve(curve_supply, from = 10, to = 25, col = "red", add = TRUE)
legend("topright", legend = c("Demand", "Supply"), col = c("blue", "red"), lty = 1)



## (f)Comparing OLS vs 2SLS Results
# OLS estimation
demand_ols <- lm(P ~ Q + PS + DI, data = truffles)
supply_ols <- lm(P ~ Q + PF, data = truffles)

# C11Q30 — Klein’s Model I: Investment Equation Estimation and Testing

This exercise applies Klein’s Model I to estimate the investment function and test for endogeneity using data from the `klein` dataset. Estimation methods include OLS, 2SLS, and hypothesis testing (Hausman and Sargan tests).

---

## (a) OLS Estimation of the Investment Function

We estimate the investment function (Equation 11.18) via ordinary least squares. The estimated regression includes the following explanatory variables:

- **P**: Current profits  
- **PLAG**: Lagged profits  
- **KLAG**: Lagged capital stock  

### Results Summary:
- **P and PLAG** both have positive and significant coefficients, consistent with the economic theory that higher profits stimulate investment.
- **KLAG** is negative and significant, indicating that a larger existing capital stock reduces the marginal incentive to invest.

> Interpretation: The coefficient signs conform to expectations. Higher profits encourage investment, while existing capital stock discourages additional capital accumulation.

<img width="682" alt="table" src="https://github.com/user-attachments/assets/f4a6ddb8-4d9f-4fea-a496-7db21a4dfe75" />

---

## (b) Reduced-Form Estimation for Profits and Joint F-Test

We estimate the reduced-form equation for profits \( P_t \), using all eight exogenous and predetermined variables as regressors.

### Hypothesis Test:
We test the joint insignificance of five variables: all regressors **except** lagged profits (Pₜ₋₁) and lagged capital (Kₜ₋₁).

- **F-statistic**: 1.93  
- **Critical value at 5% (F(5,13))**: 3.0254  

> Conclusion: Since 1.93 < 3.0254, we fail to reject the null hypothesis. These five variables do not significantly contribute to explaining profits.

We save the residuals \(\hat v_t\) and fitted values \(\hat P_t\) for subsequent testing.

---

## (c) Hausman Test for Endogeneity

To test whether **P** is endogenous in the investment equation, we include the residuals \(\hat v_t\) from the reduced-form equation into the structural equation:

### Result:
- Coefficient on \(\hat v_t\) is **highly significant** (p < 0.001)

> Conclusion: The Hausman test confirms that **P is endogenous**, justifying the use of instrumental variables.

---

## (d) 2SLS Estimation and Comparison with OLS

Using all eight exogenous and predetermined variables as instruments, we re-estimate the investment equation using **two-stage least squares (2SLS)**.

### Comparison with OLS:
- **P** is no longer statistically significant in 2SLS.
- **PLAG** becomes larger in magnitude and more significant (1% level).
- **KLAG** remains negative and highly significant, consistent with OLS.

> Interpretation: The differences between OLS and 2SLS estimates highlight the bias introduced by endogenous regressors. The 2SLS model corrects for this.

---

## (e) Second-Stage Estimation Using Fitted Profits

We estimate the second-stage model:

```math
I_t = β₁ + β₂ \hat P_t + β₃ P_{t-1} + β₄ K_{t-1} + e_t


summary(demand_ols)
summary(supply_ols)

