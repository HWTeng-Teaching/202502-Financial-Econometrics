![C05Q31_0](https://github.com/user-attachments/assets/01051e06-93f4-4f90-916d-b472af001ede)

# Exercise 5.31 

資料集：`commute5`（來自 POE5Rdata 套件）  
模型：

$$
\text{TIME} = \beta_1 + \beta_2 \cdot \text{DEPART} + \beta_3 \cdot \text{REDS} + \beta_4 \cdot \text{TRAINS} + e
$$

---

### (a) 

估計式為：

$$
\widehat{\text{TIME}} = 20.8701 + 0.3681 \cdot \text{DEPART} + 1.5219 \cdot \text{REDS} + 3.0237 \cdot \text{TRAINS}
$$

**係數解釋：**

- $\beta_1 = 20.8701$：當出發時間、紅燈數與列車數皆為 0 時的預期通勤時間。
- $\beta_2 = 0.3681$：每晚出發 1 分鐘，通勤時間將增加約 0.37 分鐘。
- $\beta_3 = 1.5219$：每多遇到一個紅燈，通勤時間將增加約 1.52 分鐘。
- $\beta_4 = 3.0237$：每多等一班火車，通勤時間將增加約 3.02 分鐘。

決定係數 $R^2 = 0.5346$，表示模型能解釋 53.5% 的變異。

---

### (b) 

| 變數       | 估計值     |se(b_k)| 95% 信賴區間                |
|------------|-----------|-------|-----------------------------|
| $\beta_1$  | 20.8701   |1.6758 |$[17.5694,\ 24.1709]$        |
| $\beta_2$  | 0.3681    |0.03510|$[0.2990,\ 0.4373]$          |
| $\beta_3$  | 1.5219    |0.1850 |$[1.1575,\ 1.8864]$          |
| $\beta_4$  | 3.0237    |0.6340 |$[1.7749,\ 4.2725]$          |

所有信賴區間皆不包含 0，代表變數在 95% 信心水準下皆顯著。

為後續計算，並附上cov matrix

![image](https://github.com/user-attachments/assets/a661d5b4-4e7f-4b87-b6e5-b99b6244511b)


---

### (c) 

- $H_0: \beta_3 \geq 2$
- $H_1: \beta_3 < 2$

$t = \frac{1.5219 - 2}{0.1850} = -2.584$  

且RR={ t: $t_{ (0.05,245) }$ $\le$ -1.651 or $t_{ (0.95,245) }$ $\ge$ 1.651 }

計算出的 t value 在拒絕域中，故拒絕虛無假設 

**結論：** 拒絕虛無假設，有統計證據顯示紅燈延誤平均小於 2 分鐘。

---

### (d) 

- $H_0: \beta_4 = 3$
- $H_1: \beta_4 \neq 3$

$t = \frac{3.02237-3}{0.6340} =0.0374$

且RR={ t: $t_{ (0.05,245) }$ $\le$ -1.651 or $t_{ (0.95,245) }$ $\ge$ 1.651 }

計算出的 t value 未在拒絕域中，故無法拒絕虛無假設 

**結論：** 無法拒絕虛無假設，火車延遲與 3 分鐘無顯著差異。

---

### (e) 

- $H_0: 30 \cdot \beta_2 < 10$
- $H_1: 30 \cdot \beta_2 \geq 10$

估計值： $30 \cdot 0.3681 = 11.04$  
SE： $30 \cdot 0.0351 = 1.053$  

$t = \frac{11.04 - 10}{1.053} = 0.991$  

且RR={ t: $t_{ (0.05,245) }$ $\le$ -1.651 or $t_{ (0.95,245) }$ $\ge$ 1.651 }

計算出的 t value 未在拒絕域中，故無法拒絕虛無假設 

**結論：** 無法拒絕虛無假設，沒有統計證據顯示延誤超過 10 分鐘。

---

### (f) 

- $H_0: \beta_4 < 3\beta_3$
- $H_1: \beta_4 \geq 3\beta_3$

$t = \frac{3.0237 - 3x1.5219}{0.8450}=-1.825$

且RR={ t: $t_{ (0.05,245) }$ $\le$ -1.651 or $t_{ (0.95,245) }$ $\ge$ 1.651 }

計算出的 t value 在拒絕域中，故拒絕虛無假設 

**結論：** 拒絕虛無假設，顯示統計證據顯示火車延誤為紅燈的三倍。

```
# 假設協方差矩陣cov_matrix
cov_matrix <- matrix(c(  2.808171830, -0.0260985055, -0.2690250770,  0.0010777876,
                         -0.026098505,  0.0012321419,  0.0004557753, -0.0104185104,
                         -0.269025077,  0.0004557753,  0.0342390502, -0.0006481936,
                          0.001077788, -0.0104185104, -0.0006481936,  0.4019709090), nrow = 4, byrow = TRUE)
# 權重向量c = [0, 0, -3, 1]
c <- c(0, 0, -3, 1)

# 計算方差
var_combination <- t(c) %*% cov_matrix %*% c

# 計算標準誤
se_combination <- sqrt(var_combination)

# 顯示結果
se_combination

```

---

### (g) 


$
H_0: \beta_1 + 30\beta_2 + 6\beta_3 + \beta_4 \leq 45 \\
$

$
H_1: \beta_1 + 30\beta_2 + 6\beta_3 + \beta_4 > 45
$

$
t = \frac{b_2 + 30b_3 + 6b_4 + b_5 - 45}{se(b_2 + 30b_3 + 6b_4 + b_5)}
$

$
= \frac{-0.93076}{0.53927} = -1.726
$

且RR={ t: $t_{ (0.05,245) }$ $\le$ -1.651 or $t_{ (0.95,245) }$ $\ge$ 1.651 }

計算出的 t value 在拒絕域中，故拒絕虛無假設 

**結論：** 拒絕虛無假設，即有統計證據顯示通勤時間超過 45 分鐘。

---

### (h)

如果 Bill 絕對不能遲到參加他的會議，他會希望能夠以高信心水準證明他的通勤時間將少於 45 分鐘。

為了達到這個目的，將「通勤時間少於 45 分鐘」設為對立假設是合理的。

相反地，若將「通勤時間少於 45 分鐘」設為虛無假設，當我們無法拒絕虛無假設時，並不能保證他的通勤時間真的會少於 45 分鐘。

若我們將虛無與對立假設設為以下形式：

$$
H_0: \beta_1 + 30\beta_2 + 6\beta_3 + \beta_4 \geq 45 \\
$$

$$
H_1: \beta_1 + 30\beta_2 + 6\beta_3 + \beta_4 < 45
$$

在本題中，計算得到的 $t$ 值為：

$$
t = \frac{b_2 + 30b_3 + 6b_4 + b_5 - 45}{se(b_2 + 30b_3 + 6b_4 + b_5)}
$$

$$
= \frac{-0.93076}{0.53927} = -1.726
$$

且RR={ t: $t_{ (0.05,245) }$ $\le$ -1.651 or $t_{ (0.95,245) }$ $\ge$ 1.651 }

計算出的 t value 在拒絕域中，故拒絕虛無假設 

**結論：** 拒絕虛無假設，表示 Bill 的預期通勤時間足夠讓他準時參加會議。

註： $se(b_2 + 30b_3 + 6b_4 + b_5)$ 可用以下code運算

```
#se(b1+30b2+6b3+b4)
# 假設協方差矩陣cov_matrix
cov_matrix <- matrix(c(  2.808171830, -0.0260985055, -0.2690250770,  0.0010777876,
                         -0.026098505,  0.0012321419,  0.0004557753, -0.0104185104,
                         -0.269025077,  0.0004557753,  0.0342390502, -0.0006481936,
                          0.001077788, -0.0104185104, -0.0006481936,  0.4019709090), nrow = 4, byrow = TRUE)

# 權重向量c = [1, 30, 6, 1]
c <- c(1, 30, 6, 1)

# 計算方差
var_combination <- t(c) %*% cov_matrix %*% c

# 計算標準誤
se_combination <- sqrt(var_combination)

# 顯示結果
se_combination
```
