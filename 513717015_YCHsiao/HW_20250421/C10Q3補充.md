
IV 與 ILS 概念進一步解釋：

1. 問題背景：

模型是：
y = β₁ + β₂ x + e

- x 是內生變數（endogenous）：它和誤差項 e 有相關性。
- z 是工具變數（instrument）：z 跟 e 無關，但跟 x 有關。

因為 x 跟 e 有相關性，不能用 OLS 直接估計 β₂，否則會有偏誤且不一致（biased and inconsistent）。
所以要用工具變數法（IV）或兩階段最小平方法（2SLS）來解決。

---

2. 什麼是工具變數？

- 條件 1（相關性 Relevance）：z 必須跟 x 有關，能解釋 x 的變異（z 幫助預測 x）。
- 條件 2（外生性 Exogeneity）：z 跟誤差項 e 無關，不受誤差影響（z 不直接影響 y，只透過 x 影響 y）。

---

3. IV估計的公式怎麼來的？

IV 估計公式：
β̂₂ = cov(z, y) / cov(z, x)

這個公式的邏輯：
- 分子：z 跟 y 的相關性，代表 z 影響 y 的力量。
- 分母：z 跟 x 的相關性，代表 z 影響 x 的力量。
- 用 z 與 y 的相關性，除以 z 與 x 的相關性，可以隔絕 e 對估計的影響。

因為 z 與 e 無關，z 與 y 的關聯完全來自 z → x → y 的路徑。

---

4. 為什麼要拆成兩個簡單回歸？

- 第一階段（First Stage）：
  x = γ₁ + θ₁ z + ν
  這是用 z 預測 x，回歸係數 θ₁ = cov(z, x) / var(z)。

- Reduced Form（簡約型式）：
  y = π₀ + π₁ z + u
  這是用 z 預測 y，回歸係數 π₁ = cov(z, y) / var(z)。

IV 估計其實就是把這兩個回歸的係數拿來相除：
β̂₂ = π̂₁ / θ̂₁

---

5. Indirect Least Squares (ILS) 的邏輯：

因為 π₁ = β₂ θ₁，所以 β₂ = π₁ / θ₁。

ILS 就是間接用這兩個回歸的結果算出 β₂：

- 第一步：用 z 對 x 做回歸，得到 θ̂₁。
- 第二步：用 z 對 y 做回歸，得到 π̂₁。
- 最後：β̂₂ = π̂₁ / θ̂₁。

---

6. ILS 與 2SLS 差在哪？

- ILS：
  - 適用於單一內生變數 + 單一工具變數的情況。
  - 思路是：直接用 π̂₁ / θ̂₁ 來算 β₂。

- 2SLS（Two-Stage Least Squares）：
  - 可以處理多個內生變數和多個工具變數。
  - 第一步：用所有工具變數預測所有內生變數，取得預測值（First Stage）。
  - 第二步：用這些預測值替代內生變數，跑 OLS（Second Stage）。

2SLS 是 ILS 的推廣版本，適用於更複雜的情況。

---

7. 直覺記法：

- IV 核心思路：
  - 找一個跟 x 有關，但跟 e 無關的變數 z，隔離 e 對估計的干擾。

- ILS 思路：
  - 第一階段：z → x（找出 z 對 x 的影響）。
  - 第二階段：z → y（找出 z 對 y 的影響）。

- 最後用公式：
  β̂₂ = （z 對 y 的影響）/（z 對 x 的影響）
