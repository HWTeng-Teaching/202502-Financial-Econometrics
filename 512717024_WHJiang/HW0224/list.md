## C02Q01 a~j (Problem)
![image](https://github.com/user-attachments/assets/9bdc617b-1206-463c-a30c-fada902dc03a)

## C02Q14 a,b,c (Problem)
![image](https://github.com/user-attachments/assets/734ed15a-1204-4eb6-8617-0822da2f0510)

## C02Q16 a,b,c,d (Computer Exercise)
![image](https://github.com/user-attachments/assets/fe8c6ba2-1391-4541-a5bd-a0ed943e2491)


### Q01
請考慮下列五個觀察值。你必須僅使用計算器完成此練習的所有部分。

| x  | y  | x – x̄ | (x – x̄)² | y – ȳ | (x – x̄)(y – ȳ) |
|----|----|--------|-----------|-------|----------------|
| 3  | 4  |        |           |       |                |
| 2  | 2  |        |           |       |                |
| 1  | 3  |        |           |       |                |
| -1 | 1  |        |           |       |                |
| 0  | 0  |        |           |       |                |
| Σxᵢ | Σyᵢ | Σ(xᵢ – x̄) | Σ(xᵢ – x̄)² | Σ(yᵢ – ȳ) | Σ(xᵢ – x̄)(y – ȳ) |

(a) 填入表格中的各個數值，並將各列的合計填在最後一行。樣本平均數 *x̄* 與 *ȳ* 為何？

(b) 利用公式 (2.7) 與 (2.8) 計算 b₁ 與 b₂，並說明它們的解釋意義。

(c) 計算 Σxᵢ² 與 Σxᵢyᵢ，並利用這些數值證明：  
  Σ(xᵢ – x̄)² = Σxᵢ² – N·x̄²  
  Σ(xᵢ – x̄)(yᵢ – ȳ) = Σxᵢyᵢ – N·x̄·ȳ

(d) 利用(b)部分求得的最小平方法估計，計算 y 的擬合值，並完成下表，最後一行填上各項合計。

| xᵢ | yᵢ | ŷᵢ | êᵢ | êᵢ² | xᵢêᵢ |
|----|----|-----|-----|------|------|
| 3  | 4  |     |     |      |      |
| 2  | 2  |     |     |      |      |
| 1  | 3  |     |     |      |      |
| -1 | 1  |     |     |      |      |
| 0  | 0  |     |     |      |      |
| Σxᵢ | Σyᵢ | Σŷᵢ | Σêᵢ | Σêᵢ² | Σxᵢêᵢ |

另外，計算：  
  y 的樣本變異數 sᵧ² = Σ(yᵢ – ȳ)² / (N – 1)  
  x 的樣本變異數 sₓ² = Σ(xᵢ – x̄)² / (N – 1)  
  x 與 y 的樣本共變異數 sₓᵧ = Σ(yᵢ – ȳ)(xᵢ – x̄) / (N – 1)  
  x 與 y 的樣本相關係數 rₓᵧ = sₓᵧ / (sₓ·sᵧ)  
  x 的變異係數 CVₓ = 100 · (sₓ / x̄)  
並求出 x 的中位數（50百分位數）。

(e) 在圖紙上繪出數據點，並描繪擬合回歸線 ŷᵢ = b₁ + b₂xᵢ。

(f) 在(e)部分的圖中，標出均值中心 (x̄, ȳ) 的位置。你的擬合直線是否通過該點？若沒有，請重新繪製。

(g) 證明對於這些數值，必有 ȳ = b₁ + b₂x̄。

(h) 證明對於這些數值，擬合值的平均數 ŷ = ȳ，其中 ŷ = Σyᵢ / N。

(i) 計算 σ̂²。

(j) 計算條件於 x 的 b₂ 的變異數 var(b₂ | x) 以及標準誤 se(b₂)。

## Ans:
### (a) 填表並求樣本均值

**原始數據：**

- x: 3, 2, 1, -1, 0  
- y: 4, 2, 3, 1, 0  

**樣本均值：**

- x̄ = (3 + 2 + 1 + (–1) + 0) / 5 = 5/5 = 1  
- ȳ = (4 + 2 + 3 + 1 + 0) / 5 = 10/5 = 2  

**各觀察值計算：**

1. **觀察值 1：**  
  x – x̄ = 3 – 1 = 2  
  y – ȳ = 4 – 2 = 2  
  (x – x̄)² = 2² = 4  
  (x – x̄)(y – ȳ) = 2×2 = 4

2. **觀察值 2：**  
  x – x̄ = 2 – 1 = 1  
  y – ȳ = 2 – 2 = 0  
  (x – x̄)² = 1  
  (x – x̄)(y – ȳ) = 1×0 = 0

3. **觀察值 3：**  
  x – x̄ = 1 – 1 = 0  
  y – ȳ = 3 – 2 = 1  
  (x – x̄)² = 0  
  (x – x̄)(y – ȳ) = 0

4. **觀察值 4：**  
  x – x̄ = –1 – 1 = –2  
  y – ȳ = 1 – 2 = –1  
  (x – x̄)² = (–2)² = 4  
  (x – x̄)(y – ȳ) = (–2)×(–1) = 2

5. **觀察值 5：**  
  x – x̄ = 0 – 1 = –1  
  y – ȳ = 0 – 2 = –2  
  (x – x̄)² = (–1)² = 1  
  (x – x̄)(y – ȳ) = (–1)×(–2) = 2

**合計：**

- Σx = 5  
- Σy = 10  
- Σ(x – x̄) = 0  
- Σ(x – x̄)² = 4 + 1 + 0 + 4 + 1 = 10  
- Σ(y – ȳ) = 2 + 0 + 1 – 1 – 2 = 0  
- Σ[(x – x̄)(y – ȳ)] = 4 + 0 + 0 + 2 + 2 = 8  

**答案 (a)：**  
樣本均值：x̄ = 1，ȳ = 2。

---

### (b) 計算迴歸係數 b₁ 與 b₂ 及其解釋

**公式：**

- b₂ = Σ[(x – x̄)(y – ȳ)] / Σ(x – x̄)²  
- b₁ = ȳ – b₂·x̄

**計算：**

- b₂ = 8 / 10 = 0.8  
- b₁ = 2 – 0.8×1 = 1.2

**解釋：**

- **b₁ (截距)：** 當 x = 0 時，預測的 y 值為 1.2。  
- **b₂ (斜率)：** 表示 x 每增加 1 單位，y 平均增加 0.8 單位。

---

### (c) 驗證均方差公式

**計算：**

- Σxᵢ² = 3² + 2² + 1² + (–1)² + 0² = 9 + 4 + 1 + 1 + 0 = 15  
- Σxᵢyᵢ = (3×4) + (2×2) + (1×3) + ((–1)×1) + (0×0) = 12 + 4 + 3 – 1 + 0 = 18

**證明：**

- Σ(x – x̄)² = Σxᵢ² – N·x̄² = 15 – 5×1² = 15 – 5 = 10  
- Σ[(x – x̄)(y – ȳ)] = Σxᵢyᵢ – N·x̄·ȳ = 18 – 5×1×2 = 18 – 10 = 8

---

### (d) 計算擬合值、殘差及其他統計量

**擬合直線：**  
ŷ = 1.2 + 0.8x

**各觀察值：**

1. **觀察值 1 (x = 3)：**  
  ŷ = 1.2 + 0.8×3 = 3.6  
  ê = 4 – 3.6 = 0.4  
  ê² = (0.4)² = 0.16  
  x·ê = 3×0.4 = 1.2

2. **觀察值 2 (x = 2)：**  
  ŷ = 1.2 + 0.8×2 = 2.8  
  ê = 2 – 2.8 = –0.8  
  ê² = (–0.8)² = 0.64  
  x·ê = 2×(–0.8) = –1.6

3. **觀察值 3 (x = 1)：**  
  ŷ = 1.2 + 0.8×1 = 2.0  
  ê = 3 – 2.0 = 1.0  
  ê² = 1.0² = 1.0  
  x·ê = 1×1.0 = 1.0

4. **觀察值 4 (x = –1)：**  
  ŷ = 1.2 + 0.8×(–1) = 0.4  
  ê = 1 – 0.4 = 0.6  
  ê² = (0.6)² = 0.36  
  x·ê = (–1)×0.6 = –0.6

5. **觀察值 5 (x = 0)：**  
  ŷ = 1.2 + 0.8×0 = 1.2  
  ê = 0 – 1.2 = –1.2  
  ê² = (–1.2)² = 1.44  
  x·ê = 0

**各項合計：**

- Σx = 5  
- Σy = 10  
- Σŷ = 3.6 + 2.8 + 2.0 + 0.4 + 1.2 = 10  
- Σê = 0.4 – 0.8 + 1.0 + 0.6 – 1.2 = 0  
- Σê² = 0.16 + 0.64 + 1.0 + 0.36 + 1.44 = 3.60  
- Σ(x·ê) = 1.2 – 1.6 + 1.0 – 0.6 + 0 = 0

**計算統計量：**

- **y 的樣本變異數：**  
  Σ(y – ȳ)² = 4 + 0 + 1 + 1 + 4 = 10  
  sᵧ² = 10 / (5 – 1) = 2.5

- **x 的樣本變異數：**  
  Σ(x – x̄)² = 10  
  sₓ² = 10 / 4 = 2.5   sₓ = √2.5 ≈ 1.5811

- **樣本共變異數：**  
  sₓᵧ = 8 / 4 = 2

- **樣本相關係數：**  
  rₓᵧ = sₓᵧ / (sₓ·sᵧ) = 2 / (√2.5×√2.5) = 2 / 2.5 = 0.8

- **x 的變異係數：**  
  CVₓ = 100 × (sₓ / x̄) ≈ 100 × 1.5811 = 158.11%

- **x 的中位數：**  
  排序 x 值：–1, 0, 1, 2, 3 → 中位數 = 1

---

### (e) 畫圖

**數據點：** (3,4), (2,2), (1,3), (–1,1), (0,0)  
**擬合回歸線：** y = 1.2 + 0.8x  
  （例如，取 (0, 1.2) 與 (1, 2.0) 連線繪圖。）

---

### (f) 均值中心

**均值中心：** (x̄, ȳ) = (1, 2)  
驗證：當 x = 1 時，y = 1.2 + 0.8×1 = 2  
  故擬合直線通過均值中心。

---

### (g) 證明 ȳ = b₁ + b₂x̄

代入：1.2 + 0.8×1 = 1.2 + 0.8 = 2 = ȳ，證明成立。

---

### (h) 證明擬合值平均數 ŷ = ȳ

Σŷ = 10，N = 5  
  平均 ŷ = 10 / 5 = 2，等於 ȳ。

---

### (i) 計算 σ̂²

σ̂² = Σê² / (N – 2) = 3.60 / (5 – 2) = 3.60 / 3 = 1.2

---

### (j) 計算 var(b₂ | x) 與 se(b₂)

**公式：** var(b₂ | x) = σ̂² / Σ(x – x̄)²  
  代入：var(b₂) = 1.2 / 10 = 0.12  
**標準誤：** se(b₂) = √(0.12) ≈ 0.3464

### Q14


考慮以下迴歸模型：

  工資 = β₁ + β₂ 學歷 + 誤差

其中，工資（WAGE）以2013年美國美元計算的時薪，學歷（EDUC）代表受教育年數（或學校教育年數）。此迴歸模型使用最小平方法估計了兩次，一次以都市地區個體為樣本，另一次以鄉村地區個體為樣本。

## 都市地區

  工資 = -10.76 + 2.46 學歷, 樣本數 N = 986  
     (標準誤)    (2.27)  (0.16)

## 鄉村地區

  工資 = -4.88 + 1.80 學歷, 樣本數 N = 214  
     (標準誤)    (3.29)  (0.24)

### (a) 彈性計算

利用鄉村地區的估計迴歸模型，計算在「均值點」上，工資對學歷的彈性。已知工資的樣本均值為 $19.74。

### (b) 彈性標準誤

都市地區的學歷樣本均值為 13.68 年。利用都市地區的估計迴歸模型，計算在「均值點」上工資對學歷的彈性之標準誤。假設均值為已知常數，不具有隨機性。

### (c) 預測工資

分別計算一個受教育 12 年以及 16 年的個體，在各區域的預測工資。



