---
title: "HW0317 - CH4 Questions 4, 28, 29"
author: "鄭凱鴻"
date: "2025-03-24"
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

# **CH4 Question 28**

## **(a) **

```{r}
setwd("C:\\Users\\User\\Downloads\\poe5rdata")
load("wa_wheat.rdata")
ls()  # 看目前有哪些變數

str(wa_wheat)
head(wa_wheat)

# 重新命名方便處理
YIELD <- wa_wheat$northampton
TIME <- wa_wheat$time

# 衍生變數
TIME2 <- TIME^2
logTIME <- log(TIME)
logYIELD <- log(YIELD)

# 四個模型
model1 <- lm(YIELD ~ TIME)
model2 <- lm(YIELD ~ logTIME)
model3 <- lm(YIELD ~ TIME2)
model4 <- lm(logYIELD ~ TIME)

# 模型比較用 R²
summary(model1)$r.squared
summary(model2)$r.squared
summary(model3)$r.squared
summary(model4)$r.squared

# 常態性檢定
shapiro.test(resid(model1))
shapiro.test(resid(model2))
shapiro.test(resid(model3))
shapiro.test(resid(model4))

# 殘差圖
par(mfrow = c(2, 2))
plot(resid(model1), type = "l", main = "Residuals - Model 1")
plot(resid(model2), type = "l", main = "Residuals - Model 2")
plot(resid(model3), type = "l", main = "Residuals - Model 3")
plot(resid(model4), type = "l", main = "Residuals - Model 4")

# 擬合圖
par(mfrow = c(2, 2))
plot(TIME, YIELD, main = "Model 1: YIELD ~ TIME")
lines(TIME, fitted(model1), col = "red", lwd = 2)

plot(TIME, YIELD, main = "Model 2: YIELD ~ log(TIME)")
lines(TIME, fitted(model2), col = "blue", lwd = 2)

plot(TIME, YIELD, main = "Model 3: YIELD ~ TIME²")
lines(TIME, fitted(model3), col = "green", lwd = 2)

plot(TIME, logYIELD, main = "Model 4: log(YIELD) ~ TIME")
lines(TIME, fitted(model4), col = "purple", lwd = 2)
```
