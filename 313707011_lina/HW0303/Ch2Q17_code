# 載入必要函式庫
library(ggplot2)

# 下載並載入 RData 數據
url <- "https://www.principlesofeconometrics.com/poe5/data/rdata/collegetown.rdata"
download.file(url, destfile = "collegetown.rdata")  # 下載檔案
load("collegetown.rdata")  # 載入數據

# 確認數據框名稱
ls()  

# 檢視數據結構
str(collegetown)  

# 2.17a

# 繪製 soft (房屋大小) 與 price (房價) 的散佈圖
ggplot(data = collegetown, aes(x = sqft, y = price)) +
  geom_point(color = "blue", alpha = 0.6) +
  labs(title = "Scatter Plot of House Price vs. House Size",
       x = "House Size (Hundreds of Square Feet)",
       y = "House Price (Thousands of Dollars)") +
  theme_minimal()


# 2.17b

# 執行線性回歸: price = β1 + β2 * sqft + e
model <- lm(price ~ sqft, data = collegetown)

# 顯示回歸結果
summary(model)

# 繪製散佈圖與回歸線
ggplot(collegetown, aes(x = sqft, y = price)) +
  geom_point(color = "blue", alpha = 0.6) +  # 繪製散佈圖
  geom_smooth(method = "lm", color = "red", se = FALSE) +  # 加入回歸線
  labs(title = "Scatter Plot with Fitted Regression Line",
       x = "House Size (Hundreds of Square Feet)",
       y = "House Price (Thousands of Dollars)") +
  theme_minimal()
