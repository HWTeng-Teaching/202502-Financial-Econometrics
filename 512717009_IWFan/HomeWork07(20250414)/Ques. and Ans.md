## Q.06

<img width="577" alt="C08Q06" src="https://github.com/user-attachments/assets/7485f4a2-a866-415a-8cb8-f25567a9586a" />


## Ans:

題目模型：

$$
\text{WAGE}_i = \beta_1 + \beta_2 \text{EDUC}_i + \beta_3 \text{EXPER}_i + \beta_4 \text{METRO}_i + e_i
$$


**(a)** 檢驗男性與女性的誤差變異數是否相等

**資料：**
- 男性樣本數 \( n_M = 577 \)， SSE\(_M = 97161.9174 \)
- 女性的標準差估計值 σ̂²_F = 12.024 → σ̂²_F = 144.5766 \)

**假設：**
-  H_0: σ̂²_M = σ̂²_F
-  H_1: σ̂²_M ≠ σ̂²_F

**計算男性誤差變異數：**

$$
\hat{\sigma}_M^2 = \frac{\text{SSE}_M}{n_M} = \frac{97161.9174}{577} \approx 168.35
$$

**GQ 檢定統計量：**

$$
GQ = \frac{\hat{\sigma}_M^2}{\hat{\sigma}_F^2} = \frac{168.35}{144.5766} \approx 1.17285
$$

**查表：**  
-  F_{573,419,0.025} = 0.8377 
-  F_{573,419,0.975} = 1.1968 

**結論：**  
因為 GQ 在不拒絕區間內 ⇒ **無法拒絕 \( H_0 \)**  
=> 無足夠證據表明兩性之間的誤差變異數不同。

---

**(b)** 檢驗已婚與單身者的誤差變異數是否不同

**資料：**
- 單身：\( n = 400 \), SSE = 56231.0382
- 已婚：\( n = 600 \), SSE = 100703.0471

**假設：**
-  H_0: σ²_SINGLE = σ²_MARRIED
-  H_1: σ²_MARRIED > σ²_SINGLE (單尾檢驗)

**計算變異數：**

$$
σ²_SINGLE = \frac{56231.0382}{400} = 140.58 \\
σ²_MARRIED = \frac{100703.0471}{600} = 167.84
$$

**F 統計量：**

$$
F = \frac{167.84}{140.58} = 1.1943
$$

**查表：**  
- F_{600,400,0.05} 臨界值大約是 1.18（單尾）

**結論：**  
因為 F > 1.18 ⇒ **拒絕 \( H_0 \)**  
=> 已婚者的誤差變異數顯著大於單身者。

---

**(c)** \( NR² \) 檢定（異質變異數檢定）

- 統計量：\( NR² = 59.03 \)
- 自由度 \( k = 5 \) 解釋變數個數
- 臨界值 \( χ²_{5,0.05} = 11.07 \)

**結論：**  
59.03 > 11.07 ⇒ **拒絕同質變異數假設**  
=> 表示回歸模型存在異質變異數

這與(b)部分的結論一致，該部分表明已婚和未婚個體的誤差方差不同。

NR²檢驗進一步證實了這一點，表明模型中確實存在異方差性，且這種異方差性與解釋變數有關。

---

**(d)** White Test

- 統計量值：78.82
- 自由度為 14 ⇒ 臨界值 \( χ²_{14,0.05} = 23.68 \)
  p(p+1)/2 - 1 = 5(5+1)/2 - 1 = 15 - 1 = 14

**結論：**  
78.82 > 23.68 ⇒ **拒絕 \( H_0 \)**  
=> 模型存在異質變異數問題。

這與(b)和(c)部分的結論一致，進一步證實了模型中存在異方差性。

---

**(e)** 比較 OLS 與 Robust 標準誤差

| 變數     | 估計值 | OLS SE | Robust SE |
|----------|--------|--------|-----------|
| 教育     | 2.50   | 0.14   | 2.50      |
| 經驗     | 0.23   | 0.031  | 0.16      |
| METRO    | 3.23   | 1.05   | 0.84      |
| FEMALE   | -4.20  | 0.81   | 0.80      |

**觀察：**
- Robust SE 對於 **EXPER** 變寬，但對 **METRO** 變窄。
- 結果沒有不一致，反而反映 White SE 更貼近實際誤差變異狀況。
  
**結論：**
- EXPER 的 robust SE > OLS SE ⇒ 估計變寬
- METRO 的 robust SE < OLS SE ⇒ 估計變窄
- 其他變數變化不大
- 解釋： White robust SE 考慮異質變異數後，更能反映真實的估計不確定性。不同變數受異質變異程度不同，導致標準誤可能變寬或變窄。

---

**(f)** MARRIED 的 t 值約為 1，是否與 (b) 衝突？

**說明：**
- (b) 是在檢定誤差變異是否不同 ⇒ 異質變異數
- (f) 是在檢定變數 MARRIED 是否對薪資有顯著解釋力

**結論：**
- 兩者 **不衝突**。
- 二者可共存，MARRIED 對薪資本身不顯著，但誤差分布變異顯著。
- MARRIED 雖對薪資無顯著影響，但其誤差變異可大於單身者 ⇒ 合理。


---

## Q.16

<img width="585" alt="C08Q16" src="https://github.com/user-attachments/assets/d7d353b0-0635-4a00-9cf2-e28e56323861" />


## Ans:

模型形式：

$$
\[
\text{MILES}_i = \beta_1 + \beta_2 \text{INCOME}_i + \beta_3 \text{AGE}_i + \beta_4 \text{KIDS}_i + e_i
\]
$$

**(a)**  OLS 回歸與信賴區間估計

回歸結果（關注 KIDS 變數）

- KIDS（小孩數量）係數估計值**：
  β̂₄ = -81.83 

- 標準誤（Standard Error）**：
 SE(β̂₄) = 27.13 

- 95% 信賴區間**為：
  \[
  [-135.33, -28.32]
  \]

結論解釋：

在控制收入（INCOME）與年齡（AGE）的情況下，每多一位小孩，平均每年旅行距離減少約 **81.83 英里**。此估計在 95% 信賴區間下為顯著的負向影響（因為信賴區間不包含 0）。

---

**(b)** 異質變異數圖形檢查：殘差圖

1. **殘差 vs INCOME**

<img width="415" alt="Residuals vs Income" src="https://github.com/user-attachments/assets/79bb8cb7-72c1-42dc-89fb-15d05bd81344" />

2. **殘差 vs AGE**

<img width="415" alt="Residuals vs Age" src="https://github.com/user-attachments/assets/4df526d3-9ef3-4633-8340-befd11dc8c33" />

觀察結果

- **Residuals vs INCOME**
- 殘差在高收入時呈現**較大變異與擴散範圍**，有類似「漏斗狀」的分佈，這是 **異質變異數的可能徵兆**。

- **Residuals vs AGE**
- 殘差相對均勻，但亦出現一些極端點（outliers）。

結論

圖形顯示 **殘差與 INCOME 之間存在變異擴大的現象**，這表明回歸模型中**可能存在異質變異數（heteroskedasticity）**。


---

**(c)**  Goldfeld–Quandt 檢定：異質變異數檢驗

檢定步驟：

1. 根據 `income` 對樣本排序
2. 分成前 90 筆（低收入）與後 90 筆（高收入）資料
3. 分別對兩組進行 OLS 回歸並計算殘差平方和 (SSE)
4. 建立 F 統計量：

<img width="108" alt="1" src="https://github.com/user-attachments/assets/72239bfb-b9ab-4a42-b341-34cce0bb3bdf" />


結果摘要：

| 項目 | 數值 |
|------|------|
| SSE（低收入組） | 8,747,917.66 |
| SSE（高收入組） | 27,291,241.29 |
| F 統計量 | **3.1197** |
| 臨界值（α = 0.05，df₁ = 86, df₂ = 86） | **1.4286** |

檢定假設：

- **虛無假設 \( H_0 \)**：σ²₁ = σ²₂ (同方差性) 高、低收入組變異數相等
- **對立假設 \( H_1 \)**：σ²₁ ﹤ σ²₂ (異方差性) 高收入組誤差變異較大

結論：

因為 \( F = 3.1197 > 1.4286 \)，所以**拒絕虛無假設**。  
這表示在 5% 顯著水準下，我們有足夠證據認為模型存在 **異質變異數（heteroskedasticity）**。

---

**(d)** 使用異質變異數穩健標準誤（White robust SE）重新估計

模型結果（KIDS）

- KIDS 估計值：
   β̂₄ = -81.83 

- Robust 標準誤（HC1）：
  SE_robust = 29.15 \)

- 95% 信賴區間：
  \[
  [-139.32, -24.33]
  \]

與 (a) 小題比較：

| 模型版本     | 估計值 | 標準誤 | 95% 信賴區間              |
|--------------|--------|--------|---------------------------|
| OLS (a)      | -81.83 | 27.13  | [-135.33, -28.32]         |
| Robust OLS (d) | -81.83 | 29.15  | [-139.32, -24.33]         |

結論：

- **估計值一致**：因為模型本身沒改變。
- **標準誤變大**：robust SE 考慮了異質變異數影響。
- **信賴區間變寬**：提高推論的保守性與真實性。

White robust 標準誤能提供在誤差變異數不相等時更可靠的推論結果。


---

**(e)**  GLS 與 Robust GLS 模型估計：考慮 Var(eᵢ) = σ²·INCOMEᵢ²

假設誤差變異數為：

$$
\[
\text{Var}(e_i) = \sigma^2 \cdot \text{INCOME}_i^2
\]
$$

並使用 **GLS (Generalized Least Squares)** 與 **Robust GLS (HC1 標準誤)** 進行估計。

GLS 模型結果（KIDS）

- KIDS 估計值**：  
  β̂₄ = -92.44 \)

- 標準誤（GLS）**：  
  SE = 39.37 

- 95% 信賴區間**：  
  \[
  [-170.09, -14.80]
  \]

Robust GLS 標準誤（White HC1）

- 標準誤：  
  SE_robust = 39.37 \)（與 GLS 相同，因模型已使用 robust SE）

- 95% 信賴區間：  
  \[
  [-170.09, -14.80]
  \]

與(a)(d)小題比較：

| 模型版本       | 估計值   | 標準誤 | 95% 信賴區間             |
|----------------|----------|--------|--------------------------|
| OLS (a)        | -81.83   | 27.13  | [-135.33, -28.32]        |
| Robust OLS (d) | -81.83   | 29.15  | [-139.32, -24.33]        |
| GLS (e)        | -92.44   | 39.37  | [-170.09, -14.80]        |

結論

- 使用 GLS 考慮收入變異權重後，**KIDS 的負向影響變得更大**。
- 標準誤也**顯著增加**，表示在此異質變異設定下，估計的不確定性更高。
- 信賴區間仍不包含 0 ⇒ 結論依然顯著。




---



## Q.18

<img width="598" alt="C08Q18" src="https://github.com/user-attachments/assets/78f2796f-895d-456f-9557-e8f20bd905f4" />


## Ans:


**(a)** 



---


